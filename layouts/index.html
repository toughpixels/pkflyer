{{ define "main" }}
<div class="grid logo-grid container tc">
  {{ with resources.Get "images/header.png" }} {{ partial "image" . }} {{ end }}
  <div class="logo">{{ partial "svg/horizontal_pk_flyer_logo.svg" . }}</div>
</div>
<div class="flex direction-column gap-sm tc">
  {{ range .Sections }}
  <h2 class="tc mb-none">{{ .Title }}</h2>
  <div class="height-lg flex justify-center mb-sm">
    {{ partial "internal-link" . }}
  </div>
  <div class="flex direction-column justify-center align-center gap-sm">
    {{ if eq (.Section) "music" }} {{ range .RegularPages }} {{ partial "music/music_preview_pane" . }}
  {{ end }} {{ else if eq (.Section) "events" }}
  <div class="flex direction-column justify-center align-center">
    {{ range .RegularPages }} {{ if ge .Params.eventDate time.Now }}
    <a href="{{ .RelPermalink }}">{{ .Title }}</a> on {{ .Params.eventDate | time.Format
    ":date_long" }} at {{ .Params.venue_name }} {{ end }} {{ end }}
  </div>
  {{ else if eq (.Section) "art" }}
  <div class="flex direction-column justify-center align-center">
    {{ range .RegularPages }} {{ if ge .Params.eventDate time.Now }}
    <span>
      <a href="{{ .RelPermalink }}">{{ .Title }}</a> on {{ .Params.eventDate | time.Format
      ":date_long" }} at {{ .Params.venue_name }}
    </span>
    {{ end }}
  </div>
  {{ end }} {{ end }}
</div>
{{ end }}
<script>
  if (window.netlifyIdentity) {
    window.netlifyIdentity.on("init", (user) => {
      if (!user) {
        window.netlifyIdentity.on("login", () => {
          document.location.href = "/admin/";
        });
      }
    });
  }
</script>
{{ end }}
